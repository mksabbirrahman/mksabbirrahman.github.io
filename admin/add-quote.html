<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Add Quote — Admin</title>
    <link rel="stylesheet" href="../style.css" />
    <style>
      main { margin:4rem 10rem; }
      form { max-width:800px; display:flex; flex-direction:column; gap:0.75rem }
      label { font-weight:600 }
      input[type=text], textarea { padding:0.6rem; border-radius:8px; border:1px solid #ddd; }
      .row { display:flex; gap:0.75rem }
      .actions { margin-top:1rem; display:flex; gap:0.5rem }
      .result { margin-top:1rem; white-space:pre-wrap; background:#f7f9fc; padding:0.75rem; border-radius:8px; border:1px solid #e2eefb }
    </style>
  </head>
  <body>
    <script>
      // Admin tools have been removed. Redirect to home.
      window.location.href = '../';
    </script>
    <nav id="desktop-nav">
      <div class="logo">Sabbir Hossen</div>
      <div>
        <ul class="nav-links">
          <li><a href="../">Home</a></li>
          <li><a href="../posts/">Posts</a></li>
        </ul>
      </div>
    </nav>

    <main>
      <h1 class="title">Add Quote (Admin)</h1>
      <p>Compose a quote and append it to the `data/quotes.json` file. This tool helps you generate the updated JSON and download it locally so you can commit it to your repo.</p>

      <form id="quote-form">
        <label for="text">Quote text</label>
        <textarea id="text" rows="3" required></textarea>

        <label for="author">Author (optional)</label>
        <input id="author" type="text" />

        <div class="actions">
          <button id="preview" class="btn btn-color-2" type="button">Preview & Build JSON</button>
          <button id="download" class="btn btn-color-1" type="button">Download updated quotes.json</button>
          <button id="copy" class="btn btn-color-2" type="button">Copy JSON</button>
        </div>
      </form>

      <div id="result" class="result" aria-live="polite"></div>
    </main>

    <script>
      async function fetchQuotes() {
        try {
          const res = await fetch('../data/quotes.json');
          if (!res.ok) return [];
          return await res.json();
        } catch (e) { return [] }
      }

      function download(filename, content) {
        const blob = new Blob([content], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url; a.download = filename; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
      }

      document.getElementById('preview').addEventListener('click', async () => {
        const text = document.getElementById('text').value.trim();
        const author = document.getElementById('author').value.trim();
        if (!text) return alert('Please enter quote text');
        const quotes = await fetchQuotes();
        quotes.push({ text, author });
        const json = JSON.stringify(quotes, null, 2);
        document.getElementById('result').textContent = json;
      });

      document.getElementById('download').addEventListener('click', async () => {
        const text = document.getElementById('text').value.trim();
        const author = document.getElementById('author').value.trim();
        if (!text) return alert('Please enter quote text');
        const quotes = await fetchQuotes();
        quotes.push({ text, author });
        const json = JSON.stringify(quotes, null, 2);
        download('quotes.json', json);
      });

      document.getElementById('copy').addEventListener('click', async () => {
        const text = document.getElementById('text').value.trim();
        const author = document.getElementById('author').value.trim();
        if (!text) return alert('Please enter quote text');
        const quotes = await fetchQuotes();
        quotes.push({ text, author });
        const json = JSON.stringify(quotes, null, 2);
        await navigator.clipboard.writeText(json);
        alert('Updated JSON copied to clipboard — paste into data/quotes.json and commit');
      });
    </script>
  </body>
</html>
